<!DOCTYPE html>
<html lang="es">
<head>
  <title>Pizzel Ep. 100 - Floppy Edition</title>
  <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">

  <script type="module">
    const TARGET_HEIGHT = 874112;

    document.addEventListener("DOMContentLoaded", async () => {
      document.getElementById("targetheight").textContent = TARGET_HEIGHT;

      let req = await fetch("https://blockchain.info/q/getblockcount?cors=true");
      const height = Number(await req.text());

      document.getElementById("currentheight").textContent = height;

      if (height >= TARGET_HEIGHT) {
        let req = await fetch(`https://blockchain.info/block-height/${TARGET_HEIGHT}?format=json&cors=true`);
        const blocks = await req.json();

        if (blocks.blocks.length === 1) {
          document.getElementById("hash").textContent = blocks.blocks[0].hash;
        }
      }
    });
  </script>
</head>
<body>
  <header>
    <h1>Pizzel Ep. 100 - Floppy Edition</title>
    <h2>Sorteo</h2>
  </header>

  <p>
    Bloque objectivo: <span id="targetheight">span>
  </p>

  <p>
    Bloque actual: <span id="currentheight">&hellip;<span>
  </p>

  <p>
    Hash: <code id="hash"><code>
  </p>
</body>
